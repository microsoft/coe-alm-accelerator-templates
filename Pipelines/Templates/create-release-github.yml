parameters:
- name: solutionName
  type: string
- name: solutionDisplayName
  type: string
- name: releaseMonth
  type: string
- name: releaseYear
  type: string
- name: connectionName
  type: string
- name: releaseNotesPath
  type: string

steps:

- powershell: |
    $releaseNotes = Get-Content '${{ parameters.releaseNotesPath }}' -Raw
    Write-Host "##vso[task.setvariable variable=ReleaseNotes]"$releaseNotes
  displayName: Build Release Notes from Milestone

- task: GitHubRelease@1
  inputs:
    gitHubConnection: ${{ parameters.connectionName }}
    tagSource: 'userSpecifiedTag'
    tag: '${{ parameters.solutionName }}-${{ parameters.releaseMonth }}${{ parameters.releaseYear }}'
    title: '${{ parameters.solutionDisplayName }} ${{ parameters.releaseMonth }} ${{ parameters.releaseYear }}'
    releaseNotesSource: inline
    releaseNotesInline: '$(ReleaseNotes)'
    changeLogType: issueBased
    isDraft: true
    isPreRelease: true
    assets: |
      $(Pipeline.Workspace)/releaseassets/*.*
  displayName: 'Create ${{ parameters.solutionDisplayName }} Release'
